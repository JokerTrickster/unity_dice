---
task_id: 02
name: profile-section
updated: 2025-09-02T10:51:20Zgithub: https://github.com/JokerTrickster/unity_dice/issues/26epic: main-page-screen
status: pending
priority: medium
estimated_hours: 12
depends_on: [01]
created: 2025-09-01T05:00:23Z
---

# Task 02: 프로필 섹션 구현 (UserDataManager 활용)

## Overview
기존 UserDataManager를 활용하여 사용자 프로필 정보를 표시하고, 획득한 프로필 중에서 선택할 수 있는 기능을 구현합니다. 성취 기반 프로필 잠금/해제 시스템을 포함합니다.

## Technical Requirements

### Data Integration
- **기존 UserData 구조 활용**:
```csharp
// 기존 UserData 확장 사용
public class ProfileData {
    public string currentProfileId;
    public List<string> unlockedProfiles;
    public Dictionary<string, DateTime> unlockDates;
}
```

### UI Components
```
ProfileSection
├── CurrentProfileDisplay
│   ├── ProfileImage (현재 선택된 프로필)
│   ├── NicknameText (UserDataManager에서 로드)
│   └── ProfileChangeButton
└── ProfileSelector (Modal/Popup)
    ├── UnlockedProfileGrid
    ├── LockedProfileGrid (잠금 아이콘)
    └── SelectButton
```

## Implementation Details

### Core Components
1. **ProfileSectionManager.cs**
   - UserDataManager와 연동
   - 프로필 선택 로직 처리
   - 성취 데이터 기반 잠금/해제 관리

2. **ProfileDisplayUI.cs**
   - 현재 프로필 및 닉네임 표시
   - 프로필 변경 버튼 이벤트 처리

3. **ProfileSelectorUI.cs**
   - 획득/미획득 프로필 목록 표시
   - 프로필 선택 및 변경 처리
   - 잠금 상태 UI 표시

### Profile Assets Management
- **기본 프로필 세트**: Resources/Profiles/ 폴더에 저장
- **Profile Metadata**: ScriptableObject로 프로필 정보 관리
```csharp
[CreateAssetMenu]
public class ProfileData : ScriptableObject {
    public string profileId;
    public Sprite profileImage;
    public string unlockCondition;
    public bool isDefault;
}
```

## Integration with Existing Systems

### UserDataManager 연동
- `UserDataManager.Instance.GetCurrentUser()` → 닉네임 로드
- `UserDataManager.Instance.UpdateProfile(profileId)` → 프로필 변경
- `UserDataManager.Instance.GetUnlockedProfiles()` → 획득 프로필 목록

### NetworkManager 연동 (기존 HTTP API 활용)
- `PUT /api/user/profile` → 서버에 프로필 변경 동기화
- `GET /api/user/achievements` → 성취 데이터 기반 프로필 해제

## Acceptance Criteria

### Functional Requirements
- [ ] 현재 설정된 프로필과 닉네임이 화면에 표시
- [ ] 프로필 클릭 시 획득한 프로필 목록 모달 표시
- [ ] 미획득 프로필은 잠금 아이콘과 함께 비활성화 표시
- [ ] 프로필 변경 시 즉시 UI 반영 및 서버 동기화
- [ ] 성취 기반 프로필 자동 해제 알림

### Technical Requirements
- [ ] UserDataManager 기존 인터페이스 재사용 (수정 최소화)
- [ ] 프로필 변경 시 NetworkManager 통해 서버 동기화
- [ ] ScriptableObject 기반 확장 가능한 프로필 관리
- [ ] 에러 처리: 네트워크 실패 시 로컬 변경 롤백

### Performance Requirements
- [ ] 프로필 변경 반영시간 1초 이내
- [ ] 프로필 이미지 로딩 최적화 (미리 로드)
- [ ] 메모리 사용량: 프로필 이미지 5MB 이하

## Testing Strategy

### Unit Tests
- `ProfileSectionManagerTests.cs`: 프로필 선택/변경 로직
- `ProfileDataTests.cs`: 프로필 메타데이터 검증

### Integration Tests  
- UserDataManager와 프로필 데이터 연동 테스트
- NetworkManager를 통한 서버 동기화 테스트
- 성취 시스템 연동 테스트 (Mock 데이터)

### UI Tests
- 프로필 선택 모달 UI 인터랙션 테스트
- 잠금/해제 상태 UI 표시 검증

## Error Handling

### Network Errors
- 프로필 변경 실패 시 이전 상태로 롤백
- 재시도 메커니즘 (최대 3회)
- 사용자 친화적 에러 메시지 표시

### Data Consistency
- 로컬 프로필 데이터와 서버 데이터 불일치 시 서버 우선
- 프로필 이미지 로딩 실패 시 기본 이미지 표시

## Dependencies
- **Internal**: UserDataManager, NetworkManager (HTTP), 기존 UI 컴포넌트
- **External**: ScriptableObject, Resources 시스템

## Definition of Done
- [ ] 기존 UserDataManager와 완벽 연동 (기존 코드 수정 최소화)
- [ ] 모든 프로필 선택/변경 기능 정상 작동
- [ ] 성취 기반 잠금/해제 시스템 구현
- [ ] 단위 테스트 및 통합 테스트 모두 통과
- [ ] 서버 동기화 에러 시나리오 모두 처리됨
- [ ] UI/UX 검토 완료 및 접근성 기준 준수